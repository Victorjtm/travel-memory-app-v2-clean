<div class="contenedor">
  <h2>Actividades para el itinerario {{ itinerarioId }}</h2>

  <!-- BotÃ³n para aÃ±adir una nueva actividad -->
  <button [routerLink]="['/formulario-actividad', viajePrevistoId, itinerarioId, 'nuevo']" class="btn-agregar">
    <i class="fa fa-plus-circle"></i> AÃ±adir Actividad
  </button>

  <hr>

  <!-- Lista de actividades -->
  <div *ngFor="let actividad of actividades">
    <h3>Actividad {{ actividad.id }}</h3>
    <p><strong>Nombre:</strong> {{ actividad.nombre }}</p>
    <p><strong>DescripciÃ³n:</strong> {{ actividad.descripcion }}</p>
    <p><strong>Horario:</strong> {{ actividad.horaInicio }} a {{ actividad.horaFin }}</p>

    <!-- âœ¨ CONTENEDOR DE BOTONES DE ACCIÃ“N -->
    <div class="acciones-actividad">
      <button class="btn-eliminar" (click)="eliminarActividad(actividad.id)">
        <i class="fa fa-trash"></i> Eliminar
      </button>
      <button class="btn-actualizar" (click)="actualizarActividad(actividad)">
        <i class="fa fa-edit"></i> Actualizar
      </button>
      <button class="btn-ver-archivos" (click)="verArchivos(actividad.id, $event)">
        <i class="fa fa-folder-open"></i> Ver Archivos
      </button>

      <!-- âœ¨ NUEVOS BOTONES -->
      <button class="btn-gpx" (click)="verGPX(actividad.id)">
        <i class="fa fa-map-marker"></i> Ver GPX
      </button>
      <button class="btn-mapa" (click)="verMapa(actividad.id)">
        <i class="fa fa-image"></i> Ver Mapa
      </button>
      <button class="btn-estadisticas" (click)="verEstadisticas(actividad.id)">
        <i class="fa fa-bar-chart"></i> EstadÃ­sticas
      </button>
    </div>

    <hr>
  </div>

  <button (click)="volverAItinerarios()">
    <i class="fa fa-arrow-left"></i> Volver a Itinerarios
  </button>
</div>

<!-- âœ¨ MODAL MAPA PNG -->
<div class="modal" *ngIf="mostrarModalMapa" (click)="cerrarModalMapa()">
  <div class="modal-contenido" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>ğŸ“ Mapa del Recorrido</h3>
      <button class="btn-cerrar" (click)="cerrarModalMapa()">âœ•</button>
    </div>
    <div class="modal-body">
      <img [src]="urlMapaDataURL" alt="Mapa del recorrido" class="mapa-imagen">
    </div>
  </div>
</div>

<!-- âœ¨ MODAL ESTADÃSTICAS -->
<div class="modal" *ngIf="mostrarModalEstadisticas" (click)="cerrarModalEstadisticas()">
  <div class="modal-contenido modal-estadisticas" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>ğŸ“Š EstadÃ­sticas del Recorrido</h3>
      <button class="btn-cerrar" (click)="cerrarModalEstadisticas()">âœ•</button>
    </div>
    <div class="modal-body" *ngIf="estadisticasActuales">
      <div class="estadistica-grupo">
        <h4>ğŸ“Œ InformaciÃ³n General</h4>
        <p><strong>Nombre:</strong> {{ estadisticasActuales.nombre }}</p>
        <p><strong>DescripciÃ³n:</strong> {{ estadisticasActuales.descripcion }}</p>
      </div>

      <div class="estadistica-grupo">
        <h4>â° Horario</h4>
        <p><strong>Inicio:</strong> {{ estadisticasActuales.horario.inicio }}</p>
        <p><strong>Fin:</strong> {{ estadisticasActuales.horario.fin }}</p>
      </div>

      <div class="estadistica-grupo">
        <h4>ğŸ“ Distancia</h4>
        <p><strong>KilÃ³metros:</strong> {{ estadisticasActuales.distancia.km }} km</p>
        <p><strong>Metros:</strong> {{ estadisticasActuales.distancia.metros }} m</p>
      </div>

      <div class="estadistica-grupo">
        <h4>â±ï¸ DuraciÃ³n</h4>
        <p><strong>Formateada:</strong> {{ estadisticasActuales.duracion.formateada }}</p>
        <p><strong>Segundos:</strong> {{ estadisticasActuales.duracion.segundos }} s</p>
      </div>

      <div class="estadistica-grupo">
        <h4>ğŸƒ Velocidad</h4>
        <p><strong>Media:</strong> {{ estadisticasActuales.velocidad.media }} km/h</p>
        <p><strong>MÃ¡xima:</strong> {{ estadisticasActuales.velocidad.maxima }} km/h</p>
        <p><strong>MÃ­nima:</strong> {{ estadisticasActuales.velocidad.minima }} km/h</p>
      </div>

      <div class="estadistica-grupo">
        <h4>âš¡ EnergÃ­a</h4>
        <p><strong>CalorÃ­as:</strong> {{ estadisticasActuales.energia.calorias }} kcal</p>
        <p><strong>Pasos:</strong> {{ estadisticasActuales.energia.pasos }}</p>
      </div>

      <div class="estadistica-grupo">
        <h4>ğŸ›°ï¸ Tracking</h4>
        <p><strong>Puntos GPS:</strong> {{ estadisticasActuales.tracking.puntosGPS }}</p>
        <p><strong>Perfil de Transporte:</strong> {{ estadisticasActuales.tracking.perfilTransporte }}</p>
      </div>
    </div>
  </div>
</div>

<!-- âœ¨ MODAL MAPA GPX INTERACTIVO CON SATÃ‰LITE -->
<div class="modal" *ngIf="mostrarModalGPXMapa" (click)="cerrarModalGPXMapa()">
  <div class="modal-contenido modal-mapa-gpx" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>ğŸ“ Recorrido GPX en SatÃ©lite</h3>
      <button class="btn-cerrar" (click)="cerrarModalGPXMapa()">âœ•</button>
    </div>
    <div class="modal-body">
      <div id="mapa-gpx-container" class="mapa-gpx-interactive"></div>
    </div>
  </div>
</div>